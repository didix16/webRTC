<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<title> Chat Node.js</title>
		<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
		<script src="/socket.io/socket.io.js"></script>
		<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
		<script>
			var GLOBALS = {
				player: null
			};
			var socket = io();

			GLOBALS.functions = {

				setPlayer: function(player){

					GLOBALS.player = player;
				},
				getPlayer: function(){

					return GLOBALS.player;
				},
				getPlayerByUrl: function(){

					var oVars = {};
					var vars = window.location.search.replace("?","").split("&");

					$.each(vars,function(k,v){

						var pair = v.split("=");
						oVars[pair[0]] = pair[1];
					});

					$fns.setPlayer(parseInt(oVars.player));
				}
			};
			
			GLOBALS.controls = {
				moveUp: function(){
					socket.emit('moveUp',{element: '#ball_p-'+$fns.getPlayer(),isController:true, player:$fns.getPlayer()});
				},
				moveDown: function(){
					socket.emit('moveDown',{element: '#ball_p-'+$fns.getPlayer(),isController:true, player:$fns.getPlayer()});
				},
				moveLeft: function(){
					socket.emit('moveLeft',{element: '#ball_p-'+$fns.getPlayer(),isController:true, player:$fns.getPlayer()});
				},
				moveRight: function(){
					socket.emit('moveRight',{element: '#ball_p-'+$fns.getPlayer(),isController:true, player:$fns.getPlayer()});
				}
			};

			$fns = GLOBALS.functions;
			$ctrl = GLOBALS.controls;

			$(function(){

				//Get the player!
				$fns.getPlayerByUrl();

				var clickEvnt = 'ontouchstart' in window ? 'touchend' : 'click';


				$("#btn_up").on(clickEvnt,function(){
					$ctrl.moveUp();
				});

				$("#btn_down").on(clickEvnt,function(){
					$ctrl.moveDown();
				});

				$("#btn_left").on(clickEvnt,function(){
					$ctrl.moveLeft();
				});

				$("#btn_right").on(clickEvnt,function(){
					$ctrl.moveRight();
				});

			});

			
		</script>
		<style type="text/css">

			body{
				margin: 0px;
			}
			button{
				border-radius: 50%;
				width: 100px;
				height: 100px;
				font-size: 50px;
			}

			button[id='btn_left']{
				transform: translate(0px,100px);
			}
			button[id='btn_down']{
				transform: translate(-105px,200px);
			}
			button[id='btn_right']{
				transform: translate(-100px,100px);
			}

			button[id='btn_a']{
				transform: translate(0px,60px);
			}

			button[id='btn_b']{
				transform: translate(0px,160px);
			}

			#controller{
			    background-color: #6415C7;
			    padding: 10px;
			    position: relative;
			    top: 0px;
			    left: 0px;
			    margin: 0px;
			    height: 100%;
			}
		</style>
	</head>
	<body>
		<div id="controller">

			<button id="btn_left" type="button">
				<i class="fa fa-arrow-left"></i>
			</button>

			<button id="btn_up" type="button">
				<i class="fa fa-arrow-up"></i>
			</button>

			

			<button id="btn_down" type="button">
				<i class="fa fa-arrow-down"></i>
			</button>

			<button id="btn_right" type="button">
				<i class="fa fa-arrow-right"></i>
			</button>

			<button id="btn_b" type="button">
				B
			</button>

			<button id="btn_a" type="button">
				A
			</button>
		</div>
	</body>
</html>